import os

from azure.core.credentials import AzureKeyCredential
from azure.search.documents import SearchClient
import openai
import time

from dotenv import load_dotenv
load_dotenv()

# インデックス名の指定
index_name = "index1"
# Cognitive SearchのエンドポイントとAPIキーを指定
endpoint = os.environ["AZURE_SEARCH_ENDPOINT"]
key = os.environ["AZURE_SEARCH_API_KEY"]

# OpenAIのAPIキーを設定 
openai.api_type = 'azure'
openai.api_base = os.environ["AZURE_OPENAI_ENDPOINT"]
openai.api_key = os.environ["AZURE_OPENAI_API_KEY"]
model_name = "text-embedding-3-large"
openai.api_version = "2024-02-01"

DOCUMENT = [
    {
        "id": "1",
        "category": "責任者会議",
        "text": """
**＜会議の背景・目的＞**

リモートワーク体制の長期化により、部署内の偶発的なコミュニケーションが減少し、情報共有の遅延や一体感の低下が懸念されている。この状況を踏まえ、現状のコミュニケーション課題を整理し、活性化させるための具体的な施策を洗い出し、実施方針を決定することを目的とする。

**＜決定事項＞**

1. **月1回のオンライン懇親会（任意参加）を実施する。** (担当：高橋)
    - 背景：業務外での気軽な交流機会を創出し、部署内の一体感を醸成するため。(佐藤、鈴木)
2. **部署内報「開発部だより（仮称）」を月刊で発行する。** (担当：田中)
    - 背景：各メンバーの業務状況やプライベートな近況などを共有し、相互理解を深めるため。(鈴木、田中)
3. **部署内のチャットツール利用ルールを見直し、周知する。** (担当：高橋)
    - 背景：雑談チャンネルの活用促進や、リアクション機能の積極利用を推奨することで、オンライン上のコミュニケーションを円滑化するため。(高橋、佐藤)

**＜ToDo＞**

- **[懇親会企画案作成]** (担当：高橋、期限：来週金曜まで)
    - 初回開催日、形式（ゲーム、テーマ別雑談等）、予算案を作成し、佐藤部長に報告する。
- **[部署内報編集担当募集・企画]** (担当：田中、期限：来週末まで)
    - 編集メンバーを部署内で公募し、初回発行に向けた企画（コーナー内容、執筆依頼等）を立案する。
- **[チャットルール改定案作成]** (担当：高橋、期限：来週水曜まで)
    - 現行ルールの課題点を踏まえ、雑談活性化、リアクション推奨等の改定案を作成し、鈴木課長にレビューを依頼する。
- **[他部署事例調査]** (担当：鈴木、期限：次週定例MTGまで)
    - 他部署で実施しているコミュニケーション活性化施策についてヒアリングし、参考情報を共有する。

**＜議事＞**

**1. 現状のコミュニケーション課題共有 (全員)**

- リモートワーク下での主な課題として、以下が挙げられた。(鈴木、高橋)
    - オフィス勤務時のような偶発的な雑談機会の著しい減少。
    - 隣の席で聞けたような、簡単な業務上の質問や情報共有の停滞感。
    - 新入社員や中途入社者が部署に早期に馴染むためのサポートの難しさ。
- 特に、業務以外の個人的な会話が減少し、メンバー間の相互理解や心理的な繋がりが以前より希薄になっている点について、多くのメンバーが懸念を示した。(田中、佐藤)

**2. コミュニケーション活性化施策の提案と討議 (全員)**

- **オンライン懇親会:**
    - 業務時間外に、任意参加で気軽に参加できる交流の場を設けるのは有効ではないか。(高橋)
    - 参加を強制せず、プレッシャーにならない形が良い。(佐藤)
    - 頻度としては、まず月1回程度で試してみてはどうか。(鈴木)
- **部署内報:**
    - 各メンバーの担当業務の状況や、趣味・近況などを共有することで、互いへの関心や理解を深めるきっかけになるのではないか。(田中)
    - 発行形式（Web、PDF等）、担当者の決め方、記事内容の収集方法などが検討課題。(鈴木)
    - まずは月刊ペースでスタートし、効果を見ながら調整するのが良い。(佐藤)
- **チャットツールの活用:**
    - 現在設置されている雑談専用チャンネルの活用度が低い現状がある。(高橋)
    - 投稿やリアクションを積極的に行うことを奨励するような、ポジティブなルールやガイドラインを設定できないか。(高橋)
    - 文字だけでなく、スタンプや絵文字の利用も推奨し、より気軽に反応しあえる雰囲気を作りたい。(田中)
- **その他のアイデア:**
    - 定期的な1on1ミーティングは継続しているが、その中で意識的に雑談や相互理解を深める時間を設けることも有効。(鈴木)
    - 定期的なオフィス出社日を設定する案も出たが、メンバーの居住地や家庭の状況が多様であるため、一律での設定は現時点では見送ることで合意。(佐藤)

**3. 施策の決定と担当割り振り (全員)**

- 上記の議論を踏まえ、実現可能性、期待される効果、実施負荷などを考慮し、「オンライン懇親会」「部署内報」「チャットルール見直し」の3つの施策を優先的に実施することで合意した。(佐藤)
- 各施策の推進担当者を決定し、具体的なアクションプラン（ToDo）と期限を設定した。（上記ToDo参照）

**4. その他・次回日程確認 (佐藤)**

- 今回決定した各施策の進捗状況については、次回の部署定例ミーティングにて確認することとした。(佐藤)
- 鈴木課長より、他部署で実施されている類似の取り組みについて情報収集を行い、参考として共有する旨の発言があった。(鈴木)

**＜次回会議予定＞**

X月Z日（火）14:00-14:30 (部署定例MTG内で進捗確認)

---

以上""",
        "text_vector": "",
    },
    {
        "id": "2",
        "category": "採用会議",
        "text": """
**＜会議の背景・目的＞**

来年度の新卒採用活動に向けて、現在の会社説明会コンテンツ（スライド、動画、配布資料等）の効果を最大化するため、内容の見直しと改善点の洗い出しを行う。特に、学生からのフィードバックや近年の採用トレンドを踏まえ、より魅力的で分かりやすいコンテンツ構成を検討することを目的とする。

**＜決定事項＞**

1. **会社説明会スライドの大幅リニューアルを実施する。** (担当：人事課_伊藤)
    - 背景：現行スライドは情報量が多く、デザインも古いため、視覚的な訴求力向上とメッセージの明確化が必要。(全員一致) 特に「事業内容」と「社風・働きがい」の部分を強化する。
2. **若手社員へのインタビュー動画を新規作成する。** (担当：広報部_小林)
    - 背景：学生が最も関心を持つ「リアルな働き方」を伝えるため、様々な部署の若手社員の声を取り入れた動画コンテンツを追加する。(中村、渡辺)
3. **説明会後の質疑応答の時間を拡充し、FAQを事前に整理・共有する。** (担当：人事課_伊藤)
    - 背景：学生の疑問解消を促進し、双方向のコミュニケーションを活性化させるため。よくある質問は事前にまとめておき、効率化を図る。(伊藤、小林)

**＜ToDo＞**

- **[説明会スライド構成案作成]** (担当：伊藤、期限：来週金曜まで)
    - 決定事項1に基づき、新しいスライド構成案（目次、各パートの主要メッセージ案）を作成し、関係者にレビュー依頼を行う。
- **[インタビュー動画企画・対象者選定]** (担当：小林、期限：再来週月曜まで)
    - 動画のコンセプト、質問項目案、撮影スケジュール案を作成する。人事部と連携し、インタビュー対象となる若手社員候補を選定する。
- **[FAQリスト作成・更新]** (担当：伊藤、期限：今月末まで)
    - 過去の説明会での質問内容や、想定される質問をリスト化し、回答案を作成する。
- **[競合他社の説明会コンテンツ調査]** (担当：渡辺、期限：来週水曜まで)
    - 同業他社や採用人気企業の会社説明会コンテンツ（Web上で公開されているもの等）を調査し、参考となる点や差別化のポイントをまとめる。

**＜議事＞**

**1. 現状の会社説明会コンテンツに関する課題認識共有 (全員)**

- 人事課 伊藤より、昨年度の説明会参加学生へのアンケート結果が共有された。主な意見として以下が挙げられた。
    - 「スライドの情報量が多く、少し分かりにくい部分があった」
    - 「もっと社員の生の声を聞きたかった」
    - 「具体的な仕事内容やキャリアパスのイメージが湧きにくかった」
- 広報部 小林より、デザイン面での古さや、視覚的な魅力に欠ける点が指摘された。ブランディングの観点からも改善が必要。
- 営業企画部 渡辺より、事業内容の説明が専門的すぎ、学生にとって魅力的に伝わっていないのではないか、という懸念が示された。顧客に提供している価値や社会への貢献といった視点を加えるべき。
- 人事部長 中村より、全体として情報伝達が一方的になりがちで、学生の興味関心を引きつけ、記憶に残るような工夫が足りない点が課題であると総括された。

**2. コンテンツ改善の方向性に関する討議 (全員)**

- **スライドコンテンツ:**
    - 情報を精査し、メッセージを絞り込む必要がある。(伊藤)
    - 図やグラフ、写真を多用し、視覚的に理解しやすいデザインへ刷新する。(小林)
    - 「なぜこの事業を行っているのか（Purpose）」、「どんな社風なのか」、「入社後にどんな成長ができるのか」といった、学生が共感しやすいストーリー性を重視する構成が良いのでは。(中村、渡辺)
- **動画コンテンツ:**
    - 社員インタビュー動画は、学生の共感を呼ぶ上で効果的。(小林)
    - 単なる業務紹介だけでなく、仕事のやりがい、苦労した経験、職場の雰囲気、プライベートとの両立など、リアルな側面を伝えることが重要。(伊藤)
    - 複数の部署、異なる年次の社員が登場することで、多様な働き方を示せると良い。(渡辺)
- **インタラクション:**
    - 質疑応答の時間をしっかり確保し、学生の疑問に丁寧に答える姿勢を見せることが信頼感につながる。(伊藤)
    - オンライン説明会の場合、チャット機能やQ&A機能を活用し、リアルタイムで質問を受け付け、回答する仕組みも検討すべき。(小林)
    - 事前にFAQを準備しておくことで、基本的な質問への対応時間を短縮し、より深い質疑応答に時間を割ける。(中村)

**3. 具体的な改善施策と担当割り振り (全員)**

- 上記の議論を踏まえ、優先的に取り組むべき改善策として「スライドのリニューアル」「若手社員インタビュー動画の新規作成」「質疑応答の拡充とFAQ整備」の3点を決定した。(中村)
- 各施策の担当者を決定し、具体的なアクションプラン（ToDo）と期限を設定した。（上記ToDo参照）
- 競合他社の動向調査も並行して行い、差別化戦略に活かすこととした。(渡辺担当)

**4. 今後のスケジュール確認 (中村)**

- 各ToDoの期限を確認し、次回の打ち合わせで進捗報告と具体的なコンテンツ案のレビューを行うことを確認した。(中村)
- リニューアルしたコンテンツは、夏頃に実施予定のインターンシップ説明会から導入を目指す方向で進める。(中村)

**＜次回会議予定＞**

A月C日（金）13:00-14:00 (場所：第3会議室)

---

以上""",
        "text_vector": "",
    },
    {
        "id": "3",
        "category": "開発部会議",
        "text": """
**＜会議の背景・目的＞**

長年にわたり運用されている基幹システム「Phoenix」において、技術的負債（複雑化したコード、古いフレームワーク・ライブラリへの依存、テスト自動化の不足、ドキュメント不備等）が蓄積し、改修コストの増大、障害リスクの増加、新技術導入の阻害要因となっている。この状況を改善するため、技術的負債の現状を再確認し、具体的な解消に向けたロードマップ策定の第一歩として、基本方針と優先的に取り組むべき課題を議論・決定することを目的とする。

**＜決定事項＞**

1. **技術的負債解消の基本方針として、「リファクタリング中心のアプローチ」を当面の主軸とする。** (担当：開発本部全体)
    - 背景：全面的なリプレイスはリスクとコストが高すぎるため、段階的かつ継続的な改善を目指す。ただし、特定モジュールについてはマイクロサービス化などのリ・アーキテクチャも視野に入れる。(佐々木、渡辺、山田)
2. **優先的に解消すべき課題として、「特定バッチ処理の性能劣化」と「フロントエンドフレームワークのEOL対応」の2点を特定する。** (担当：Phoenixチーム_加藤、アーキテクト_山田)
    - 背景：前者は業務影響度が大きく、後者はセキュリティリスクと開発効率低下に直結するため、早期の対応が必要。(加藤、田中、鈴木)
3. **技術的負債解消のための専任チーム（または兼務での時間確保）の必要性を認め、リソース配分について開発本部長が検討する。** (担当：開発本部長_佐々木)
    - 背景：通常開発と並行して負債解消を進めるには、意識的なリソース確保が不可欠であるため。(渡辺、加藤)

**＜ToDo＞**

- **[バッチ処理性能調査・改善策立案]** (担当：加藤、山田、期限：来月末まで)
    - 性能劣化している特定バッチ処理（売上集計バッチ等）のボトルネック調査（SQLチューニング、ロジック見直し等）を実施し、具体的な改善計画を立案する。
- **[フロントエンド移行計画策定]** (担当：山田、加藤、期限：再来週金曜まで)
    - EOLを迎える現行フレームワーク（例: Struts 1.x）から、後継フレームワーク（例: Spring Boot + React/Vue.jsなど）への移行パス、影響範囲、段階的移行の可否などを検討し、計画案を作成する。
- **[リソース配分案検討]** (担当：佐々木、渡辺、期限：来週開催の本部長定例まで)
    - 技術的負債解消に割り当てる工数（例: 開発工数の10-20%目安、専任メンバー設置等）の実現可能性と具体的な配分案を検討する。
- **[静的コード解析ツール導入評価]** (担当：山田、田中、期限：来月末まで)
    - コードの複雑度計測や潜在的なバグ検出を目的とした静的コード解析ツール（SonarQube等）の導入効果と実現性を評価する。
- **[インフラ観点での課題整理]** (担当：鈴木、期限：来週水曜まで)
    - 現行システムのOS、ミドルウェアのバージョンアップ計画との整合性や、コンテナ化（Docker/Kubernetes）による環境改善の可能性について、インフラ観点からの課題・提言をまとめる。

**＜議事＞**

**1. 基幹システム「Phoenix」の技術的負債に関する現状認識共有 (加藤、山田、田中)**

- Phoenixチーム 加藤リーダーより、現状の主な技術的負債について説明。
    - **コード複雑性:** 特定モジュールにおける循環的複雑度（Cyclomatic Complexity）の高さ、長大メソッド、コピー＆ペーストによる重複コードの散見。
    - **フレームワーク・ライブラリ陳腐化:** Struts 1.x、古いバージョンのSpring Framework、サポート切れのライブラリへの依存。セキュリティパッチ適用も困難な状況。
    - **テスト自動化不足:** 単体テストのカバレッジが低く、リグレッションテストは手動に依存。改修時のデグレードリスクが高い。
    - **ドキュメント不備:** 設計書と実装の乖離、ドキュメント自体の不足。属人化を招いている。
- アーキテクト 山田より、アーキテクチャ観点での課題を補足。
    - モノリシックな構造による機能間の密結合。一部の改修が広範囲に影響。
    - データベーススキーマの複雑化、インデックス不足による性能問題。
- 品質保証部 田中より、リリース前のテスト工数の増大、本番環境での障害発生頻度の微増傾向を報告。技術的負債が品質低下に繋がっている可能性を指摘。

**2. 技術的負債解消の基本方針に関する討議 (全員)**

- 全面リプレイス（スクラッチ開発）案も出たが、開発期間、コスト、移行リスクを考慮すると現実的ではないとの意見で一致。(佐々木、渡辺)
- 現行システムを維持しつつ、継続的にコード品質を改善していく「リファクタリング」を基本戦略とすることで合意。(山田、加藤)
- ただし、将来的な拡張性や柔軟性を考慮し、特に独立性の高い機能や新規開発部分については、マイクロサービス化などのモダンなアーキテクチャへの段階的な移行も検討対象とする。(山田、佐々木)
- インフラ基盤部 鈴木より、クラウド移行（リフト＆シフト、リプラットフォーム）も選択肢として検討すべきとの意見あり。将来的なインフラ刷新計画と連携して検討を進める。

**3. 優先的に取り組むべき課題の特定 (全員)**

- 現状の課題の中から、業務影響度、緊急度（セキュリティリスク等）、改善効果の観点から、優先順位を議論。
- 「特定バッチ処理の性能劣化」は、月末の締め処理遅延など直接的な業務影響が出ているため、最優先。(加藤、渡辺)
- 「フロントエンドフレームワークのEOL対応」は、放置すると深刻な脆弱性を突かれるリスクがあるため、緊急度が高い。(山田、田中、鈴木)
- その他、テスト自動化推進、CI/CD環境整備、ドキュメント整備なども重要だが、まずは上記2点の解決に注力し、成功体験を積むことが望ましいとの結論に至った。(佐々木)

**4. 推進体制とリソースに関する議論 (全員)**

- 技術的負債解消は、通常の機能追加・改修案件とは別に、計画的に取り組む必要がある。(渡辺)
- 担当チーム（Phoenixチーム）の通常業務負荷が高い中、どのように解消作業を進めるかが課題。(加藤)
- 負債解消に特化した時間（例：スプリント内の一定割合、週1日の集中デー）を確保するか、期間限定で専任メンバーをアサインする必要があるのでは。(山田、佐々木)
- 最終的なリソース配分は、開発本部長 佐々木が各部長と調整の上、決定することになった。

**5. その他 (佐々木)**

- 技術的負債の可視化と継続的な計測（メトリクス定義、ツール導入）も今後の課題として認識。(佐々木、田中)
- 今回の決定事項とToDoの進捗は、隔週で開催している開発本部定例でトラッキングしていくことを確認。(佐々木)

**＜次回会議予定＞**

各ToDoに関する個別打ち合わせは随時設定。

全体進捗確認は次々回の開発本部定例（F月G日予定）にて実施。

---

以上""",
        "text_vector": "",
    },
    {
        "id": "4",
        "category": "責任者会議",
        "text": """
**＜会議の背景・目的＞**

来月ローンチ予定の新商品「Smart Organizer X」の初期プロモーションキャンペーンの効果を最大化し、適切に評価するため、主要なKPI（重要業績評価指標）を設定することを目的とする。

**＜決定事項＞**

1. **キャンペーン期間（ローンチ後1ヶ月）における主要KPIを以下3点とする。** (担当：全員合意)
    - **認知度向上:** 主要メディア掲載数、Webサイトへのキャンペーン経由流入数（ユニークユーザー数）
    - **見込み顧客獲得:** 製品資料ダウンロード数、問い合わせフォーム送信数
    - **初期売上:** キャンペーン期間中の「Smart Organizer X」販売個数
2. **各KPIの具体的な目標数値を設定する。** (担当：木村、斎藤)
    - 背景：目標を明確にすることで、施策の有効性を判断しやすくするため。過去の類似商品ローンチ実績や市場予測に基づき設定する。
3. **KPI計測のためのツールとレポートフォーマットを準備する。** (担当：斎藤、中村)
    - 背景：正確なデータ収集と、関係者間でのスムーズな進捗共有のため。Google Analytics、MAツール、メディアクリッピングサービス等を活用。

**＜ToDo＞**

- **[KPI目標数値設定]** (担当：木村、斎藤、期限：今週金曜まで)
    - 決定事項2に基づき、各KPIの具体的な目標数値を算出し、吉田部長に提出する。
- **[計測ツール設定確認・レポートフォーマット作成]** (担当：斎藤、中村、期限：来週水曜まで)
    - 必要な計測タグの設定、レポート項目、更新頻度を定義したフォーマット案を作成する。
- **[広報活動KPI連携]** (担当：中村、木村、期限：今週木曜まで)
    - 広報活動（プレスリリース配信、メディアリレーション）が認知度KPIにどう貢献するかを整理し、連携を確認する。

**＜議事＞**

1. **キャンペーン概要と目的の再確認 (木村)**
    - プロダクトマネージャー木村より、新商品「Smart Organizer X」のターゲット顧客、提供価値、キャンペーン全体の目的（初期認知獲得と販売促進）について改めて説明があった。
2. **KPI候補の洗い出しと議論 (全員)**
    - **認知度指標:** Web広告のインプレッション数、SNSでの言及数（エンゲージメント数）、指名検索数なども候補として挙がったが、計測の容易さと重要度から「メディア掲載数」と「Webサイト流入数」を主指標とすることで合意。(吉田、斎藤)
    - **見込み顧客指標:** セミナー申込数も候補だったが、今回は初期段階のため、よりハードルの低い「資料DL数」「問い合わせ数」を重視。(木村、吉田)
    - **売上指標:** 販売個数をシンプルに追うことで合意。金額ベースは後日分析。(木村)
    - その他、顧客満足度やNPSなども重要だが、ローンチ直後の短期キャンペーンKPIとしては一旦対象外とする。(吉田)
3. **目標設定と計測方法について (斎藤、中村)**
    - 目標数値はストレッチ目標ではなく、現実的な達成ラインを意識して設定する方針を確認。(吉田)
    - Web流入はGoogle Analyticsで計測。メディア掲載はクリッピングサービスと広報担当による目視確認。資料DL/問い合わせはMAツールで計測。販売個数は基幹システムから抽出。(斎藤、中村)
    - レポートは週次で主要数値を共有し、キャンペーン終了後に詳細分析を行う流れを確認。(吉田)

**＜次回会議予定＞**

来週金曜 13:00-13:30 (KPI目標値と計測準備状況の確認)""",
        "text_vector": "",
    },
    {
        "id": "5",
        "category": "開発部会議",
        "text": """
**＜会議の背景・目的＞**

顧客からの問い合わせ対応の効率化と顧客満足度向上を目指し、現状のWebサイトFAQコンテンツの課題を整理するとともに、問い合わせ削減策としてチャットボット導入の是非を検討することを目的とする。

**＜決定事項＞**

1. **現行FAQコンテンツの全面的な見直し・拡充を実施する。** (担当：CSリーダー_藤本)
    - 背景：情報が古い、検索性が低い、回答が分かりにくいといった課題がオペレーターから多数指摘されたため。(藤本、森田)
2. **チャットボット導入について、費用対効果と運用体制を考慮し、段階的な導入を検討する方向で進める。** (担当：CS部長_岡田、Web担当_石川)
    - 背景：問い合わせ削減効果は期待できる一方、導入コスト、シナリオ作成・メンテナンス負荷も考慮が必要なため、まずは限定的な範囲（特定製品FAQなど）での導入を視野に入れる。(岡田、石川)
3. **FAQ改善と並行して、問い合わせ分類データの精度向上に取り組む。** (担当：CSリーダー_藤本)
    - 背景：どのFAQを重点的に改善すべきか、チャットボットでどの質問に対応すべきかを判断するためのデータ分析基盤を強化する必要があるため。(岡田、藤本)

**＜ToDo＞**

- **[FAQ改善計画策定]** (担当：藤本、森田、期限：来月末まで)
    - 問い合わせログ分析に基づき、優先的に改善・追加すべきFAQ項目リストを作成。構成案、ライティング方針をまとめ、岡田部長に提出する。
- **[チャットボットツール情報収集・比較]** (担当：石川、藤本、期限：再来週金曜まで)
    - 主要なチャットボットツールの機能、価格、導入事例を調査し、比較表を作成する。
- **[問い合わせ分類見直し・オペレーター研修]** (担当：藤本、期限：来月中旬まで)
    - 現在の問い合わせ分類項目を見直し、より分析しやすい体系に整理する。オペレーター向けに分類基準の研修を実施する。
- **[チャットボット導入効果試算]** (担当：石川、岡田、期限：来月末まで)
    - 問い合わせ削減数、人件費削減効果、顧客満足度向上効果などを試算し、導入判断の材料とする。

**＜議事＞**

1. **現状のFAQと問い合わせ対応の課題共有 (藤本、森田)**
    - CSリーダー藤本より、FAQアクセス数に対し、解決率が低い現状を報告。特に新機能や料金体系に関する情報更新が追いついていない。
    - オペレーター代表森田より、同じような質問が繰り返し寄せられる状況、FAQを見ても解決できずに電話やメールで問い合わせてくる顧客が多い実態を共有。FAQの検索性の悪さ、専門用語が多く分かりにくい点を指摘。
2. **FAQ改善の方向性について (全員)**
    - 単純なQ&A形式だけでなく、図解や動画コンテンツの活用、関連FAQへのリンク強化など、コンテンツリッチ化が必要。(石川)
    - 顧客が使う言葉（検索キーワード）を意識したライティング、カテゴリー分類の見直しによるナビゲーション改善も重要。(藤本)
    - 問い合わせログを定期的に分析し、FAQコンテンツを継続的に更新・改善していく運用体制の確立が必要。(岡田)
3. **チャットボット導入の可能性について (全員)**
    - 定型的な質問への自動応答によるオペレーター負荷軽減、24時間対応による顧客利便性向上といったメリットが期待される。(石川)
    - 一方で、導入・運用コスト、シナリオ設計の複雑さ、AIの回答精度への懸念、有人対応へのスムーズなエスカレーション設計の必要性などが挙げられた。(岡田、藤本)
    - まずはFAQでカバーしきれない、頻度の高い定型質問に絞って導入し、効果を見ながら範囲を拡大していくアプローチが良いのでは。(岡田、石川)
4. **今後の進め方 (岡田)**
    - FAQ改善を最優先で進めつつ、チャットボット導入に向けた情報収集と効果試算を並行して行うことを確認。(岡田)
    - データに基づいた意思決定のため、問い合わせ分類の整備も重要タスクとして位置づける。(岡田)

**＜次回会議予定＞**

再来週末目途 (チャットボットツール比較結果、FAQ改善計画の骨子共有)""",
        "text_vector": "",
    },
    {
        "id": "6",
        "category": "開発部会議",
        "text": """
**＜会議の背景・目的＞**

第2生産ラインにおける自動化プロジェクト（ロボット導入、搬送システム連携）の進捗状況を確認し、発生している課題への対策、および今後のスケジュールについて関係者間で認識を合わせることを目的とする。

**＜決定事項＞**

1. **ロボットアーム（A社担当）のティーチング遅延について、A社は増員し、来週末までにキャッチアップを図る。** (担当：A社_山田)
    - 背景：当初計画よりティーチング作業に時間を要しており、後続の工程への影響が懸念されるため、リソース追加で遅延を解消する。(佐藤、A社_山田)
2. **搬送システム（B社担当）と既存設備との連携インターフェース仕様について、最終確認を本日中に実施する。** (担当：佐藤、鈴木、B社_高橋)
    - 背景：一部仕様に不明瞭な点があり、手戻りを防ぐため、稼働テスト前に完全な合意を得る必要がある。(鈴木、B社_高橋)
3. **自動化ライン稼働後のオペレーター向けトレーニング計画を具体化する。** (担当：佐藤、鈴木)
    - 背景：スムーズな立ち上げと安全確保のため、操作方法、異常時対応、基本的なメンテナンスに関するトレーニングプログラムを早期に策定する必要がある。(田中工場長)

**＜ToDo＞**

- **[ティーチング人員追加・進捗報告]** (担当：A社_山田、期限：来週末)
    - 増員後のティーチング進捗状況を毎日、佐藤課長へ報告する。
- **[インターフェース仕様最終確認・合意]** (担当：佐藤、鈴木、B社_高橋、期限：本日中)
    - 関係者で仕様書をレビューし、合意サインを取り交わす。
- **[オペレータートレーニング計画案作成]** (担当：佐藤、鈴木、期限：来週金曜まで)
    - トレーニング内容、対象者、スケジュール、マニュアル案を作成し、田中工場長に提出する。
- **[設置エリア安全対策最終チェック]** (担当：鈴木、期限：今週金曜まで)
    - ロボット稼働範囲の安全柵、センサー、非常停止ボタン等の設置状況と機能確認を再度実施する。

**＜議事＞**

1. **全体スケジュールと各社担当範囲の進捗確認 (佐藤)**
    - 生産技術課 佐藤課長より、プロジェクト全体のマスタープランを提示し、現在のフェーズ（設置・調整段階）を確認。
    - A社 山田氏より、ロボットアーム本体の設置は完了したが、ワーク（対象物）ごとのティーチング作業が想定より難航しており、3日程度の遅延が発生している旨の報告。
    - B社 高橋氏より、搬送コンベア、センサー類の設置は完了。既存設備とのPLC（プログラマブルロジックコントローラ）連携に関するインターフェース仕様について、最終確認が必要な箇所が数点残っている旨の報告。
2. **課題と対策の協議 (全員)**
    - **ティーチング遅延:** 原因はワークの個体差による微調整の多さ。A社は経験豊富なエンジニアを追加投入し、週末返上で遅れを取り戻すことを約束。(A社_山田、佐藤)
    - **インターフェース仕様:** 信号のタイミング、エラーコードの定義など、具体的な項目についてその場で質疑応答と確認を実施。本日中に最終版をFIXさせることで合意。(佐藤、鈴木、B社_高橋)
    - **安全対策:** 設備保全 鈴木係長より、現時点での安全対策状況を報告。立ち入り禁止エリアの明示、センサー感度調整など、稼働前の最終チェック項目を確認。(鈴木)
3. **今後のマイルストーンと留意点 (田中工場長、佐藤)**
    - 田中工場長より、遅延回復を最優先としつつも、安全確保を絶対条件とするよう改めて指示。
    - 佐藤課長より、来週の連携テスト、再来週の試運転、翌月からの本稼働というマイルストーンを再確認。
    - 本稼働に向けたオペレーターのトレーニングと習熟期間の重要性を強調し、計画策定を急ぐよう指示。(田中工場長、佐藤)

**＜次回会議予定＞**

来週水曜 09:00-09:30 (連携テスト直前確認)""",
        "text_vector": "",
    },
    {
        "id": "7",
        "category": "開発部会議",
        "text": """
**＜会議の背景・目的＞**
クライアント（株式会社〇〇商事）より受注した次期顧客管理システム（以下、新CRM）開発プロジェクトの正式な開始にあたり、プロジェクトの目的、スコープ、体制、スケジュール概要、コミュニケーションルール等を関係者間で共有・確認し、円滑なプロジェクト推進のスタートを切ることを目的とする。

**＜決定事項＞**

プロジェクトの主要目的とゴールを再確認し、合意した。

目的：現行システムの老朽化に伴う課題（操作性、データ連携、保守性）を解決し、営業活動の効率化とデータに基づいた意思決定支援を実現する。

ゴール：YYYY年M月末までにフェーズ1（基本機能）をリリースする。(全員合意)

プロジェクト体制と各担当者の役割分担を承認した。 (上記参加者リストに準拠) (全員合意)

主要なコミュニケーションツールと定例会議を設定した。 (担当：PM_鈴木)

ツール：課題管理はBacklog、チャット連絡はSlack（専用チャンネル開設）、ドキュメント共有はGoogle Driveを使用する。

定例会議：毎週火曜日 10:00-11:00 に進捗確認会議を実施する。

最初のマイルストーン（要件定義完了）の目標期日をYYYY年K月末と設定した。 (担当：PM_鈴木、クライアント_田中、佐藤)

**＜ToDo＞**

[詳細要件定義ヒアリング日程調整] (担当：PM_鈴木、クライアント_佐藤、期限：本日中)

来週から開始する詳細要件定義のためのヒアリングセッション（複数回）の日程を調整する。

[コミュニケーションツール招待・設定] (担当：PM_鈴木、期限：明日AMまで)

関係者をBacklog、Slackのプロジェクトスペースへ招待し、必要な設定を行う。

[開発環境・インフラ初期構築開始] (担当：開発リーダー_高橋、インフラ_中村、期限：来週金曜まで)

開発メンバー用のリポジトリ、CI/CDパイプラインの初期設定、開発用サーバ環境の準備を開始する。

[画面遷移図・ワイヤーフレーム素案作成] (担当：デザイナー_伊藤、期限：再来週月曜まで)

現行システムの調査と事前ヒアリングに基づき、主要画面の遷移図とワイヤーフレームのドラフトを作成する。

[クライアント側 現行システム資料準備] (担当：クライアント_佐藤、期限：今週金曜まで)

現行システムの機能一覧、業務フロー図、画面キャプチャなど、開発の参考となる資料を開発会社側に提供する。

**＜議事＞**

1. プロジェクト概要説明 (PM_鈴木)

PM鈴木より、本プロジェクトの背景、目的、期待される効果、大まかなスコープ（フェーズ1で実装する主要機能群）、全体スケジュール（マイルストーン）について説明。

特に、現行システムの課題解決と、将来的な機能拡張性（マーケティングオートメーション連携など）を見据えた設計の重要性を強調。

1. プロジェクト体制と役割紹介 (全員)

クライアント側、開発会社側の各担当者が自己紹介と本プロジェクトにおける役割、意気込みを述べた。

クライアント田中部長より、本プロジェクトへの期待と、社内調整への協力姿勢が示された。

1. 開発アプローチと技術スタックについて (開発リーダー_高橋)

開発リーダー高橋より、アジャイル的な要素を取り入れた反復型開発アプローチ（2週間程度のスプリントを想定）を提案。

主要技術スタック（バックエンド: Python/Django, フロントエンド: React, DB: PostgreSQL, インフラ: AWS）の選定理由と概要について説明。クライアント側からの技術的な質問に対応。

1. UI/UXデザイン方針について (デザイナー_伊藤)

デザイナー伊藤より、新CRMで目指すデザインコンセプト（シンプルさ、直感的な操作性、データ可視化）と、今後のデザインプロセス（ワイヤーフレーム作成→モックアップ作成→プロトタイピング）について説明。

1. コミュニケーションと課題管理について (PM_鈴木)

決定事項3で合意したツール（Backlog, Slack, Google Drive）の具体的な使い方、報告・連絡・相談のルール、定例会議のアジェンダ案について説明。

仕様に関する質疑はBacklogの課題として起票し、履歴を残すことを推奨。

1. クライアントからの要望・懸念事項ヒアリング (クライアント_田中、佐藤)

クライアント佐藤様より、特に営業担当者が日々の活動を入力しやすいUI/UXへの強い要望があった。現行システムでの入力負荷が高い点が課題。

データ移行（現行CRMからのデータ吸い上げ）に関する懸念と、移行計画の詳細説明を早期に求める声があった。

田中部長より、予算とスケジュールの遵守、および定期的な進捗報告の重要性が改めて強調された。

1. リスク確認と質疑応答 (全員)

想定されるリスク（要件定義の遅延、仕様変更の発生、クライアント側担当者の多忙によるレビュー遅延、技術的課題等）について簡単に触れ、早期発見・早期対応の重要性を共有。

その他、各担当者から出た細かな質問事項について質疑応答を実施。

**＜次回会議予定＞**
来週火曜日 10:00-11:00 定例進捗会議 (オンライン)""",
        "text_vector": "",
    },
]

for doc in DOCUMENT: 
 # テキストをベクトル化 
    response_title = openai.Embedding.create(input=doc['text'],engine=model_name)
    doc['text_vector'] = response_title['data'][0]['embedding']
    time.sleep(10)
# インデックスの内容を格納
search_client = SearchClient(endpoint, index_name, AzureKeyCredential(key))
# ドキュメントのアップロード
result = search_client.upload_documents(documents=DOCUMENT) 
# アップロードの結果を表示
print("ドキュメントの登録に成功しました: {}".format(result[0].succeeded))